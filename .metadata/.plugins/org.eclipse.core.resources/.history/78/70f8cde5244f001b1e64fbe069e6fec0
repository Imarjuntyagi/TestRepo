package couponTest;

import java.util.Random;
import java.util.concurrent.TimeUnit;

import org.openqa.selenium.By;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.chrome.ChromeDriver;
import org.testng.annotations.Test;

public class ONETest {
	
	
	@Test
	public   void methodname() throws InterruptedException {
		
		 int n = 8; 
		 
			
			String SALTCHARS = "ABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890";
	        StringBuilder salt = new StringBuilder();
	        Random rnd = new Random();
	        while (salt.length() < 9) { // length of the random string.
	            int index = (int) (rnd.nextFloat() * SALTCHARS.length());
	            salt.append(SALTCHARS.charAt(index));
	        }
	        String saltStr = salt.toString();
			
		  
	        // Get and display the alphanumeric string 
		
		System.setProperty("webdriver.chrome.driver",
				"/home/arjun/eclipse-workspace/CouponCode/Chromedriver/chromedriver.exe");
		WebDriver driver = new ChromeDriver();
		driver.manage().timeouts().implicitlyWait(20, TimeUnit.SECONDS);
		driver.manage().deleteAllCookies();
		driver.manage().window().maximize();
		driver.get("https://www.mykirana.com/admin/index.php?route=common/login/employee");
		driver.findElement(By.xpath("//input[@placeholder='Username / Email']"))
				.sendKeys("hasibur.rahman@kartrocket.com");
		driver.findElement(By.xpath("//input[@placeholder='Password']")).sendKeys("hasibur@123");
		driver.findElement(By.xpath("//button[@id='login-btn']")).click();
		driver.findElement(By.xpath("//button[@onclick=\"login('admin')\"]")).click();
		Thread.sleep(4000);
		driver.findElement(By.xpath("//span[contains(text(),'Coupons')]")).click();
		Thread.sleep(2000);

		driver.findElement(By.xpath("//a[contains(text(),'Manage Coupons')]")).click();
		Thread.sleep(2000);
	
		driver.findElement(By.xpath("//li/a[contains(text(),'Create Coupon')]")).click();

		driver.findElement(By.xpath("//form/div/div/fieldset/div[1]/div/select"));
		driver.findElement(By.xpath("//div/div/fieldset/div[2]/div/input")).sendKeys("Automatedcoupon");
		driver.findElement(By.xpath("//div/div/fieldset/div[3]/div/input")).sendKeys(saltStr);
		Thread.sleep(2000);
		
		driver.findElement(By.xpath("//input[@name='app']")).click();
		
		driver.findElement(By.xpath("//option[@value='F']")).click();   // used to select fixed amount from drop down
		
//		driver.findElement(By.xpath("//span[@class='multiselect-selected-text']")).click();
//		driver.findElement(By.xpath("//span[@class='multiselect-selected-text']")).click();
//		driver.findElement(By.xpath("//option[@value='F']")).click();
		Thread.sleep(2000);


		driver.findElement(By.xpath("//input[@name='uses_total']")).sendKeys("1");
		driver.findElement(By.xpath("//input[@name='uses_customer']")).sendKeys("1");

		driver.findElement(By.xpath(
				"/html/body/div[3]/div[3]/div[2]/article/section/div[2]/form/div/div/fieldset/div[9]/div[1]/div/input[@name='discount']"))
				.sendKeys("1000");
		driver.findElement(By.xpath(
				"/html/body/div[3]/div[3]/div[2]/article/section/div[2]/form/div/div/fieldset/div[9]/div[2]/div/input[@name='total']"))
				.sendKeys("2000");
		Thread.sleep(2000);

		// #######################################################################
		driver.findElement(By.xpath("//input[@type='checkbox' and @value='8']")).click();

		driver.findElement(By.xpath("//textarea[@name='description']"))
				.sendKeys("This coupon code is generated for testing purpose");

		driver.findElement(By.xpath("//input[@name='retailer_coupon_usage_flag']")).sendKeys("1");
		driver.findElement(By.xpath("//input[@name='uses_per_customer_flag']")).sendKeys("1");
		driver.findElement(By.xpath("//input[@name='uses_per_device_cap']")).sendKeys("1");
		driver.findElement(By.xpath("//input[@name='uses_per_device_flag']")).sendKeys("1");

		driver.findElement(By.xpath("//input[@name='uses_per_whitelisted_cap']")).sendKeys("1");

		driver.findElement(By.xpath("//input[@name='uses_per_whitelisted_flag']")).sendKeys("1");
		Thread.sleep(2000);	
//       JavascriptExecutor js = (JavascriptExecutor) driver;
//       js.executeScript("window.scrollBy(1000,0)");
//       
       driver.findElement(By.xpath("//img[@style='display: block; height: 50px; width:50px; ']")).click();
		Thread.sleep(2000);	


		driver.findElement(By.xpath("//*[@id=\"page-content\"]/div[2]/article/header/ul/li[1]/a")).click();
       System.out.println("New Coupon created successfully with code:"+saltStr); 


	}
	
	

}
